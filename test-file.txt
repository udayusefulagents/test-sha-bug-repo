Testing with improved type checking for SHA